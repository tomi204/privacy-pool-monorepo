<svg width="800" height="600" viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
     refX="9" refY="3.5" orient="auto" markerUnits="strokeWidth">
      <polygon points="0 0, 10 3.5, 0 7" fill="black"/>
    </marker>
    <marker id="dashed-arrow" markerWidth="10" markerHeight="7" 
     refX="9" refY="3.5" orient="auto" markerUnits="strokeWidth">
      <polygon points="0 0, 10 3.5, 0 7" fill="blue"/>
    </marker>
    <marker id="red-arrow" markerWidth="10" markerHeight="7" 
     refX="9" refY="3.5" orient="auto" markerUnits="strokeWidth">
      <polygon points="0 0, 10 3.5, 0 7" fill="red"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="black">BurnTo Process - Voucher Creation</text>
  
  <!-- Actors/Components -->
  <!-- User -->
  <rect x="50" y="50" width="80" height="40" fill="#e6e6fa" stroke="black" stroke-width="2" rx="5"/>
  <text x="90" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">User</text>
  
  <!-- EncryptedERC -->
  <rect x="200" y="50" width="120" height="40" fill="#fff0e6" stroke="black" stroke-width="2" rx="5"/>
  <text x="260" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">EncryptedERC</text>
  
  <!-- Voucher System -->
  <rect x="380" y="50" width="120" height="40" fill="#f0e6ff" stroke="black" stroke-width="2" rx="5"/>
  <text x="440" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Voucher System</text>
  
  <!-- E-Pool -->
  <rect x="560" y="50" width="100" height="40" fill="#ffe6f0" stroke="black" stroke-width="2" rx="5"/>
  <text x="610" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold">E-Pool</text>
  
  <!-- Vertical lifelines -->
  <line x1="90" y1="90" x2="90" y2="550" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="260" y1="90" x2="260" y2="550" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="440" y1="90" x2="440" y2="550" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="610" y1="90" x2="610" y2="550" stroke="black" stroke-width="2" stroke-dasharray="5,5"/>
  
  <!-- User state -->
  <rect x="20" y="110" width="140" height="30" fill="#ffffcc" stroke="black" stroke-width="1"/>
  <text x="90" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">Has: eERC tokens, wants voucher</text>
  
  <!-- 1. Prepare burnTo -->
  <rect x="20" y="160" width="140" height="40" fill="#ffffcc" stroke="black" stroke-width="1"/>
  <text x="90" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">Generate:</text>
  <text x="90" y="190" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">ZK proof for burn</text>
  
  <!-- 2. Call burnToVoucher -->
  <line x1="90" y1="220" x2="260" y2="220" stroke="black" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="175" y="210" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">burnToVoucher(amount, proof)</text>
  
  <!-- 3. Validate Proof -->
  <rect x="200" y="240" width="120" height="40" fill="#fff0e6" stroke="black" stroke-width="1"/>
  <text x="260" y="255" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">Validate ZK proof</text>
  <text x="260" y="270" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">Check balance</text>
  
  <!-- Decision Diamond (Visual representation) -->
  <polygon points="260,300 300,320 260,340 220,320" fill="white" stroke="black" stroke-width="2"/>
  <text x="260" y="325" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">Valid?</text>
  
  <!-- SUCCESS PATH -->
  <!-- 4a. Burn eERC -->
  <line x1="260" y1="360" x2="260" y2="390" stroke="black" stroke-width="2" marker-end="url(#arrowhead)"/>
  <rect x="200" y="390" width="120" height="30" fill="#fff0e6" stroke="black" stroke-width="1"/>
  <text x="260" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">burn(user, amount)</text>
  
  <!-- 5a. Create Voucher -->
  <line x1="260" y1="440" x2="440" y2="440" stroke="black" stroke-width="2" marker-end="url(#arrowhead)"/>
  <text x="350" y="430" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">createVoucher(encryptedAmount)</text>
  
  <!-- 6a. Generate voucher -->
  <rect x="380" y="460" width="120" height="40" fill="#f0e6ff" stroke="black" stroke-width="1"/>
  <text x="440" y="475" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">Generate voucher ID</text>
  <text x="440" y="490" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">Store encrypted data</text>
  
  <!-- 7a. Return voucher -->
  <line x1="440" y1="520" x2="90" y2="520" stroke="blue" stroke-width="2" stroke-dasharray="3,3" marker-end="url(#dashed-arrow)"/>
  <text x="265" y="510" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="blue">VoucherCreated event</text>
  
  <!-- FAILURE PATH (from decision) -->
  <line x1="220" y1="320" x2="90" y2="320" stroke="red" stroke-width="2" marker-end="url(#red-arrow)"/>
  <text x="155" y="310" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="red">revert("Invalid proof")</text>
  
  <!-- SUCCESS label -->
  <text x="300" y="360" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="green">SUCCESS</text>
  
  <!-- FAILURE label -->
  <text x="140" y="340" font-family="Arial, sans-serif" font-size="9" font-weight="bold" fill="red">FAILURE</text>
  
  <!-- Optional: Deposit to E-Pool -->
  <line x1="20" y1="540" x2="760" y2="540" stroke="gray" stroke-width="2"/>
  <text x="400" y="535" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="gray">OPTIONAL: Deposit Voucher to E-Pool</text>
  
  <!-- Final user state -->
  <rect x="680" y="110" width="100" height="50" fill="#f0f0f0" stroke="gray" stroke-width="1" stroke-dasharray="2,2"/>
  <text x="730" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold">User now has:</text>
  <text x="730" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">Encrypted voucher</text>
  <text x="730" y="155" text-anchor="middle" font-family="Arial, sans-serif" font-size="9">(ready for E-Pool)</text>
  
  <!-- Legend -->
  <rect x="680" y="200" width="110" height="80" fill="white" stroke="black" stroke-width="1"/>
  <text x="735" y="220" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold">Legend</text>
  <line x1="690" y1="230" x2="720" y2="230" stroke="black" stroke-width="2"/>
  <text x="730" y="235" font-family="Arial, sans-serif" font-size="8">Function call</text>
  <line x1="690" y1="245" x2="720" y2="245" stroke="blue" stroke-width="2" stroke-dasharray="3,3"/>
  <text x="730" y="250" font-family="Arial, sans-serif" font-size="8">Event/Success</text>
  <line x1="690" y1="260" x2="720" y2="260" stroke="red" stroke-width="2"/>
  <text x="730" y="265" font-family="Arial, sans-serif" font-size="8">Failure/Revert</text>
  <rect x="690" y="270" width="20" height="10" fill="#ffffcc" stroke="black" stroke-width="1"/>
  <text x="720" y="278" font-family="Arial, sans-serif" font-size="8">Process</text>
</svg>